<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Eternal Momentum VR</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- A‑Frame core library for building WebXR scenes -->
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <!-- Additional helpers for physics, interactions and super‑hands (grabbing with controllers) -->
  <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-super-hands-component@5.0.1/dist/aframe-super-hands-component.min.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!--
    Hidden 2D canvas.  The original Eternal Momentum game renders into this
    off‑screen canvas.  In this VR port the canvas content is wrapped
    around the player on a cylinder so you can glance up and see the
    familiar 2D battlefield in all directions.  Because the canvas is
    hidden in the DOM, it does not interfere with VR rendering but its
    contents are still updated every frame by script.js.
  -->
  <!--
    Off‑screen canvas used by the original Eternal Momentum game.  Its ID is
    "gameCanvas" to satisfy references inside the game code.  The cylinder
    around the player uses this canvas as a texture to project the 2D
    battlefield.  Keep the canvas hidden in the DOM.
  -->
  <canvas id="gameCanvas" width="2048" height="1024" style="display:none;"></canvas>

  <a-scene embedded background="color: #000">
    <a-assets>
      <!-- Directional audio for the aberration core.  Additional assets can be placed in the assets directory. -->
      <audio id="coreSound" src="assets/core_sound.wav"></audio>
    </a-assets>

    <!-- Camera rig.  It contains the camera and both controllers.  The rig is positioned
         so that the player's eyes start at 1.6 m above the platform.  Movement
         controls are disabled because this game uses a stationary platform; users
         move their avatar by grabbing and dragging the box. -->
    <a-entity id="rig" position="0 1.6 0">
      <a-camera id="camera" wasd-controls-enabled="false"></a-camera>
      <!-- Left hand controller with laser pointer and interaction components -->
      <a-entity id="leftHand" laser-controls="hand: left" raycaster="objects: .interactive" super-hands></a-entity>
      <!-- Right hand controller -->
      <a-entity id="rightHand" laser-controls="hand: right" raycaster="objects: .interactive" super-hands></a-entity>
    </a-entity>

    <!-- Circular platform on which the player stands.  The platform is slightly
         raised above ground and large enough that the UI table sits outside
         its edge. -->
    <a-cylinder id="platform" radius="3.5" height="0.2" color="#222" position="0 0 0"></a-cylinder>

    <!-- Waist‑high table encircling the player.  This is where status panels,
         cooldown timers and other UI widgets live.  A ring is used instead of
         multiple boxes to create a continuous table surface without seams. -->
    <a-ring id="uiTable" radius-inner="3.4" radius-outer="3.6" theta-length="360" rotation="-90 0 0" position="0 1 0" color="#333"></a-ring>

    <!-- Score and health panel.  Placed slightly forward and to the right of the
         player so it is easily visible when glancing down at the table.  Two
         text elements display the current score and health; they are updated
         dynamically by script.js every frame. -->
    <a-plane id="scorePanel" width="1.2" height="0.6" color="#111" position="2 1.2 -0.5" rotation="0 -30 0">
      <a-text id="scoreText" value="Score: 0" position="0 0.15 0.01" align="center" width="1.0" color="#fff"></a-text>
      <a-text id="healthText" value="Health: 100" position="0 -0.15 0.01" align="center" width="1.0" color="#fff"></a-text>
    </a-plane>

    <!-- Aberration core representation.  A glowing sphere slowly spins and
         emits a continuous tone using positional audio.  When the core’s
         active power is used, script.js will start a cooldown timer and
         update the panel below accordingly.  The core itself is interactive
         and can be grabbed or clicked if additional gameplay mechanics are
         added later. -->
    <a-sphere id="coreModel" radius="0.3" color="#d62728" position="-2 1.5 -1" class="interactive">
      <a-animation attribute="rotation" dur="8000" to="360 360 0" repeat="indefinite" easing="linear"></a-animation>
      <a-sound src="#coreSound" autoplay="true" loop="true" positional="true" volume="0.5"></a-sound>
    </a-sphere>
    <a-plane id="coreCooldownPanel" width="0.6" height="0.3" color="#111" position="-2 1.0 -1" rotation="0 30 0">
      <a-text id="cooldownText" value="Core cooldown: Ready" align="center" width="0.5" color="#fff"></a-text>
    </a-plane>

    <!-- Cylindrical surface that wraps the 2D game canvas around the player.  A
         custom component defined in script.js (canvas-texture) copies the
         canvas into a texture every frame.  The cylinder is open‑ended so
         that you can see the platform and table without obstruction. -->
    <a-entity id="gameCylinder" geometry="primitive: cylinder; radius: 6; height: 2.5; openEnded: true" position="0 1.6 0"
              material="color: #555" canvas-texture="#gameCanvas"></a-entity>

    <!-- Draggable avatar that represents the player’s position on the 2D canvas.
         The super‑hands component adds behaviours such as grabbable and
         draggable.  When the avatar is released, script.js updates the
         underlying game state and redraws the 2D canvas accordingly. -->
    <a-box id="playerAvatar" width="0.5" height="0.5" depth="0.5" color="#00aaff" position="0 1.0 -2"
           class="interactive grabbable hoverable stretchable draggable">
      <a-text value="You" align="center" color="#fff" position="0 0.4 0"></a-text>
    </a-box>

    <!-- script.js contains game logic and canvas updates.  Load it as an ES
         module so it can import the game's modules and call into them. -->
    <script type="module" src="script.js"></script>
  </a-scene>
</body>
</html>